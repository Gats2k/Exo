DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
INFO:app:L'utilisateur a demandé une nouvelle conversation
INFO:app:Nouvelle conversation créée avec thread_id ad38b6a0-9c8c-4d38-8ca8-e0a3e5409db0
(661) accepted ('172.31.128.3', 43480)
160.120.141.248,10.82.9.111,172.31.128.3 - - [09/Apr/2025 22:54:46] "GET /admin/data/web HTTP/1.1" 200 29099 2.963189
DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Server', b'nginx/1.18.0'), (b'Date', b'Wed, 09 Apr 2025 22:54:46 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'23'), (b'Connection', b'keep-alive'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'Access-Control-Allow-Origin', b'*'), (b'Access-Control-Allow-Methods', b'GET, POST, OPTIONS'), (b'Access-Control-Expose-Headers', b'Content-Length,Content-Type,Date,Server,Connection')])
INFO:httpx:HTTP Request: POST https://api.telegram.org/bot7755734631:AAFNaU0BYBIbZjIFUBq7jx5VtppyulmSQZ8/getUpdates "HTTP/1.1 200 OK"
DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:receive_response_body.complete
DEBUG:httpcore.http11:response_closed.started
DEBUG:httpcore.http11:response_closed.complete
DEBUG:telegram.ext.ExtBot:Call to Bot API endpoint `getUpdates` finished with return value `[]`
DEBUG:telegram.ext.ExtBot:No new updates found.
DEBUG:telegram.ext.ExtBot:Calling Bot API endpoint `getUpdates` with parameters `{'timeout': 10, 'offset': 0, 'allowed_updates': [<UpdateType.MESSAGE>, <UpdateType.EDITED_MESSAGE>, <UpdateType.CHANNEL_POST>, <UpdateType.EDITED_CHANNEL_POST>, <UpdateType.INLINE_QUERY>, <UpdateType.CHOSEN_INLINE_RESULT>, <UpdateType.CALLBACK_QUERY>, <UpdateType.SHIPPING_QUERY>, <UpdateType.PRE_CHECKOUT_QUERY>, <UpdateType.POLL>, <UpdateType.POLL_ANSWER>, <UpdateType.MY_CHAT_MEMBER>, <UpdateType.CHAT_MEMBER>, <UpdateType.CHAT_JOIN_REQUEST>, <UpdateType.CHAT_BOOST>, <UpdateType.REMOVED_CHAT_BOOST>, <UpdateType.MESSAGE_REACTION>, <UpdateType.MESSAGE_REACTION_COUNT>, <UpdateType.BUSINESS_CONNECTION>, <UpdateType.BUSINESS_MESSAGE>, <UpdateType.EDITED_BUSINESS_MESSAGE>, <UpdateType.DELETED_BUSINESS_MESSAGES>, <UpdateType.PURCHASED_PAID_MEDIA>]}`
DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_headers.complete
DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
DEBUG:httpcore.http11:send_request_body.complete
DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
INFO:app:Utilisation de la conversation existante 81 avec thread_id ad38b6a0-9c8c-4d38-8ca8-e0a3e5409db0
INFO:app:Traitement d'image détecté: utilisation de la méthode non-streaming
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.mathpix.com:443
DEBUG:urllib3.connectionpool:https://api.mathpix.com:443 "POST /v3/text HTTP/1.1" 200 3931
DEBUG:app:Résultat Mathpix obtenu: 5204 caractères
DEBUG:app:Contenu formaté extrait: 2346 caractères
INFO:app:Définition du titre pour nouvelle conversation avec image: 'Analyse d'image'
DEBUG:openai._base_client:Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'Note primaire à respecter à tout prix : "Pour les notations mathématiques, utilise une écriture simple et condensée. N\'utilise jamais le langage LaTex, absolument jamais, même lorsque cela est nécessaire, ne l\'utilise absolument pas, nous allons privilégier les écritures simples qui sont celles qui sont le plus couramment utilisé et le plus facilement compréhensible par les élèves, tu trouveras ci-dessous quelques exemples qui illustrent comment je veux que tu utilises le langage mathématique et tu verras que le langage LaTex doit être jeté au profit du langage simple comme le montre les exemples que je te donne\xa0ci-dessous. Par exemple :\n\n- Pour les dérivées, utilise les crochets avec un prime : [f(x)]\' au lieu de \\frac{d}{dx}(f(x))\n- Pour les fonctions composées, utilise la notation fog(x) au lieu de f∘g(x)\n- Pour les racines carrées, utilise √ au lieu de \\sqrt\n- Pour les fractions simples, utilise / au lieu de \\frac{}{}\n- Pour les fractions, utilise a/b au lieu de \\frac{a}{b}\n- Pour les ensembles, utilise R, N, Z au lieu de \\mathbb{R}, \\mathbb{N}, \\mathbb{Z}\n- Pour le logarithme naturel, utilise ln au lieu de \\ln\n- Pour les puissances, utilise x^n au lieu de x^{n}\n- Pour les indices, utilise x_n au lieu de x_{n}\n- Pour les symboles grecs, utilise α, β, π au lieu de \\alpha, \\beta, \\pi\n- Pour l\'infini, utilise ∞ au lieu de \\infty\n- Pour les inéga...